#!/bin/sh

killall --quiet polybar
while pgrep --exact polybar > /dev/null; do sleep 1; done

monitors=$(xrandr |
  grep '\bconnected\b' |
  sed 's/primary //' |
  cut --fields=1,3 --delimiter=' ' |
  uniq --skip-fields 1 |
  cut --fields=1 --delimite=' '
)
for display in $monitors; do
  MONITOR=$display polybar top &
done
